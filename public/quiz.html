<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Demon Slayer</title>
    <link rel="stylesheet" href="./css/quiz.css">
    <link rel="shortcut icon" href="./img/Icons/Demon-Slayer-Logo (1).ico">
</head>
<body>
    <div> 
    <button class="button back">
        <a href="./index.html">
            Voltar
        </a>
    </button>    
    </div>
    
        <div class="container">
       
        <div id="box_div" class="question-container hide">
            <center class="question">Pegunta sobre Demon Slayer Aqui</center>
            <div id="respostas_div" class="answers-container">
                <button onclick="selecionarResposta()" class="answer button" disabled>Resposta 1</button>
                <button onclick="selecionarResposta()" class="answer button">Resposta 2</button>
                <button onclick="selecionarResposta()" class="answer button">Resposta 3</button>
                <button onclick="selecionarResposta()" class="answer button">Resposta 4</button>
            </div>
        </div>
        <div class="controls-container">
            <button id="start_btn" onclick="iniciarQuiz()" class="button">
                Começar Quiz
            </button>        
            <button id="next_btn" onclick="nextQuestion()" class="button hide">
                Proxima Pergunta
            </button>
        </div>
    </div>


</body>
</html>

<script>
    
    const perguntaText = document.querySelector(".question");
    let perguntaAtual = 0;
    let totalAcertos = 0; 

    start_btn.addEventListener("click", iniciarQuiz);
    next_btn.addEventListener("click", nextQuestion);


    function iniciarQuiz(){
        start_btn.classList.add("hide");
        box_div.classList.remove("hide");  
        nextQuestion();
    }

    function nextQuestion(){
        resetTudo();
        
        if(questions.length === perguntaAtual){
            return finishGame();
        }

        perguntaText.textContent = questions[perguntaAtual].question
        questions[perguntaAtual].answers.forEach(answer =>{
            const novaResposta = document.createElement("button")
            novaResposta.classList.add( "answer" , "button" )
            novaResposta.textContent = answer.text
            if(answer.correct){
                novaResposta.dataset.correct = answer.correct
                
            }
            respostas_div.appendChild(novaResposta)
            
            novaResposta.addEventListener("click", selecionarResposta)
        
        })
    }

    function resetTudo(){
        while(respostas_div.firstChild){
                respostas_div.removeChild(respostas_div.firstChild);
            };
            document.body.classList.remove("correct" , "incorrect");
            next_btn.classList.add("hide");
    }

    function selecionarResposta(event){
        const respostaSelecionada = event.target;

        if(respostaSelecionada.dataset.correct){
            document.body.classList.add("correct");
            totalAcertos ++
        }else{
            document.body.classList.add("incorrect");
        }
        console.log(event.target);

        modificarCorBotao()

        next_btn.classList.remove("hide");
        perguntaAtual ++

    }
    function modificarCorBotao(){
        document.querySelectorAll(".answer").forEach(button =>{
            if(button.dataset.correct === "true"){
                button.classList.add("correct")
            }else{
                button.classList.add("incorrect")
            }
            button.disabled = true
        })
    }


    function finishGame(){
        const totalQuestões = questions.length
        const acertos = Math.floor(totalAcertos * 100 / totalQuestões)

        let mensagem = ""

        if(acertos >= 90){
            mensagem = ":)"
        }else if(acertos >= 70){
            mensagem = ":)"
        }else if(acertos >= 50) {
            mensagem = ":|"
        }else{
            mensagem = ":("
        }

        box_div.innerHTML = `
           <center>
            <p>você acertou ${totalAcertos}/${acertos} de ${totalQuestões} questões!</p>
            <br>
            <p>Resultado ${mensagem}</p>
            <center>
            <br>
            <button class="button" onclick="voltarParaDashboard()">Ver Ranking</button>
        `


    }

    function voltarParaDashboard(){
        setTimeout(function () {
            window.location = "./dashboard/cards.html";
          }, 1000); 
    }
        


    const questions = [
        {
            question: "Pergunta 1",
            answers: [
                {text: "Resposta 1", correct:false},
                {text: "Resposta 2", correct:false},
                {text: "Resposta 3", correct:true},
                {text: "Resposta 4", correct:false}
            ]
        },
        {
            question: "Pergunta 2",
            answers: [
                {text: "Resposta 1", correct:false},
                {text: "Resposta 2", correct:false},
                {text: "Resposta 3", correct:true},
                {text: "Resposta 4", correct:false}
            ]
        },
        {
            question: "Pergunta 3",
            answers: [
                {text: "Resposta 1", correct:false},
                {text: "Resposta 2", correct:false},
                {text: "Resposta 3", correct:true},
                {text: "Resposta 4", correct:false}
            ]
        },
        {
            question: "Pergunta 4",
            answers: [
                {text: "Resposta 1", correct:false},
                {text: "Resposta 2", correct:false},
                {text: "Resposta 3", correct:true},
                {text: "Resposta 4", correct:false}
            ]
        },
        {
            question: "Pergunta 5",
            answers: [
                {text: "Resposta 1", correct:false},
                {text: "Resposta 2", correct:false},
                {text: "Resposta 3", correct:true},
                {text: "Resposta 4", correct:false}
            ]
        },
        {
            question: "Pergunta 6",
            answers: [
                {text: "Resposta 1", correct:false},
                {text: "Resposta 2", correct:false},
                {text: "Resposta 3", correct:true},
                {text: "Resposta 4", correct:false}
            ]
        },
        {
            question: "Pergunta 7",
            answers: [
                {text: "Resposta 1", correct:false},
                {text: "Resposta 2", correct:false},
                {text: "Resposta 3", correct:true},
                {text: "Resposta 4", correct:false}
            ]
        },
        {
            question: "Pergunta 8",
            answers: [
                {text: "Resposta 1", correct:false},
                {text: "Resposta 2", correct:false},
                {text: "Resposta 3", correct:true},
                {text: "Resposta 4", correct:false}
            ]
        },
        {
            question: "Pergunta 9",
            answers: [
                {text: "Resposta 1", correct:false},
                {text: "Resposta 2", correct:false},
                {text: "Resposta 3", correct:true},
                {text: "Resposta 4", correct:false}
            ]
        },
        {
            question: "Pergunta 10",
            answers: [
                {text: "Resposta 1", correct:false},
                {text: "Resposta 2", correct:false},
                {text: "Resposta 3", correct:true},
                {text: "Resposta 4", correct:false}
            ]
        },
        {
            question: "Pergunta 11",
            answers: [
                {text: "Resposta 1", correct:false},
                {text: "Resposta 2", correct:false},
                {text: "Resposta 3", correct:true},
                {text: "Resposta 4", correct:false}
            ]
        },
        {
            question: "Pergunta 12",
            answers: [
                {text: "Resposta 1", correct:false},
                {text: "Resposta 2", correct:false},
                {text: "Resposta 3", correct:true},
                {text: "Resposta 4", correct:false}
            ]
        },
    ]

</script>